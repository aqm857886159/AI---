# AI 嘚吧嘚 ✨

> 让 AI 帮你润色文章，像朋友一样给你真诚的建议

一款智能写作助手，结合多位 AI 专家的点评和精准的段落级修订功能，帮助你写出更好的文章。

---

## 核心功能 🎯

### 1️⃣ 全文 AI 修订

一键优化整篇文章，AI 会：
- 修正错别字和语病
- 优化语句流畅度
- 增强表达力度
- **为每处修改提供具体理由**（如"修正标点"、"优化逻辑衔接"等）

**如何使用：**
1. 在编辑器中写入或粘贴你的文章
2. 点击右侧侧边栏标题"AI嘚嘚"旁边的**紫色"全文修订"按钮**
3. 等待 AI 分析完成（会显示"AI正在后台修订中..."）
4. 文章中会出现**红字删除**和**绿字添加**的修改标记
5. 每处修改都有**理由气泡说明**（鼠标悬停查看）
6. 点击每处修改旁边的 **✓ 接受** 或 **✗ 拒绝**
7. 或点击顶部修订工具栏的 **"✓ 全部接受"** / **"✗ 全部拒绝"**

---

### 2️⃣ 选区 AI 修订（划词精修）

选中部分文字，让 AI 只优化这一段：

**如何使用：**
1. 用鼠标选中你想优化的段落（**可以跨多段**）
2. 松开鼠标后会弹出一个 **✨ 图标工具条**
3. 点击 **✨**，AI 开始分析
4. 右侧评论区会显示 AI 专家的点评
5. **编辑器内直接显示修改建议**（红删绿增）
6. 同样可以逐条接受/拒绝

**特别说明：**
- 支持**多段落选择**，AI 会保持段落结构不变
- 每段的修改理由都会单独标注
- 不会出现"段落合并"问题

---

### 3️⃣ AI 专家团点评

4 位性格各异的 AI 专家会从不同角度给你建议：
- **问题诊断型**：指出文章的硬伤和改进点
- **老练型**：从专业角度提炼核心观点
- **严谨型**：检查逻辑和表达是否准确
- **炫酷型**：增加文采和趣味性

点评会显示在**右侧评论区**，你可以：
- 阅读每位专家的建议
- 点击评论卡片，**基于该建议生成修订**

---

### 4️⃣ 智能标题生成

**如何使用：**
1. 写完文章后，点击顶部的 **"标题生成"** 按钮
2. AI 会推荐一个吸引人的标题
3. 同时告诉你为什么推荐这个标题
4. 一键应用到文章标题

---

## 快速上手 🚀

### 第一步：配置 API Key

1. 点击右上角 **⚙️ 设置** 按钮
2. 输入你的 OpenRouter API Key（支持 DeepSeek V3.2 等模型）
3. 保存配置

> 💡 **获取 API Key**：访问 [OpenRouter](https://openrouter.ai/) 注册并获取

---

### 第二步：开始写作

在编辑器中输入或粘贴你的文章，最少 50 字即可开始使用 AI 功能。

---

### 第三步：选择修订方式

| 修订方式 | 使用场景 | 入口 |
|---------|---------|------|
| **全文修订** | 整篇文章需要优化 | 右侧"AI嘚嘚"旁的紫色按钮 |
| **选区修订** | 只想改某几段 | 选中文字后点击 ✨ |
| **基于评论修订** | 想按专家建议修改 | 点击评论卡片 |

---

## 修订模式详解 📝

### 内联 Diff（红删绿增）

修订生成后，你会看到：
- <span style="background:#ffe6e6;text-decoration:line-through;">红色删除线</span> = 删除的内容
- <span style="background:#e6ffe6;">绿色背景</span> = 新增的内容
- **💡 气泡** = 修改理由（鼠标悬停查看）

每处修改都可以独立操作：
- **✓ 接受**：应用这处修改
- **✗ 拒绝**：保持原文

---

### 修订工具栏

当有修订待处理时，顶部会出现：

```
📝 修订模式    [3 个修改]    [✓ 全部接受]  [✗ 全部拒绝]
```

- **全部接受**：一键应用所有修改
- **全部拒绝**：放弃所有修改，恢复原文

---

## 界面布局 🖼️

```
┌─────────────────────────────────────────────────────────┐
│  AI 嘚吧嘚          [⚙️ 设置]  [标题生成]                 │
├─────────────────────────────────────────────────────────┤
│                                                         │
│                    编辑器区域                            │
│                                                         │
│   - 输入/粘贴文章                                        │
│   - 显示修订的红删绿增                                    │
│   - 接受/拒绝修改按钮                                     │
│                                                         │
└─────────────────────────────────────────────────────────┘

右侧侧边栏（AI嘚嘚）
┌─────────────────────┐
│ AI嘚嘚  [全文修订] [🔄]│
├─────────────────────┤
│  👤 专家 A          │
│  📝 评论内容...      │
├─────────────────────┤
│  👤 专家 B          │
│  📝 评论内容...      │
└─────────────────────┘
```

---

## 常见问题 ❓

### Q1: 为什么点击"全文修订"没反应？
- 确保文章至少有 50 字
- 检查是否配置了 API Key
- 查看控制台是否有错误信息

### Q2: 选中文字后没有出现 ✨ 图标？
- 确保选中的是**非空文本**
- 如果当前有未处理的修订，工具条会隐藏（需要先处理完修订）

### Q3: 修改的理由都是"优化表达"？
- 旧版本存在此问题，最新版已修复
- 清除浏览器缓存并刷新页面

### Q4: 多段选择后段落被合并了？
- 最新版已修复此问题
- 现在支持精准的多段落修订，结构完全保留

### Q5: 点击按钮后白屏？
- 已修复"设置"按钮导致的崩溃问题
- 如遇白屏，刷新页面即可恢复

---

## 技术栈 🛠️

- **前端框架**: React + TypeScript + Vite
- **编辑器**: Tiptap (基于 ProseMirror)
- **状态管理**: Zustand
- **AI 服务**: OpenRouter API (支持 DeepSeek V3.2)
- **样式**: Vanilla CSS (玻璃态设计)
- **Diff 算法**: 自定义段落级 & 行内 Diff

---

## 开发指南 👨‍💻

### 本地运行

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build
```

### 项目结构

```
src/
├── components/          # UI 组件
│   ├── EditorNew.tsx    # 主编辑器（带修订插件）
│   ├── CommentPanel.tsx # 评论侧边栏
│   └── ...
├── services/            # AI 服务和工具
│   ├── openrouter.ts    # OpenRouter API 封装
│   ├── paragraphDiff.ts # 段落级 Diff
│   └── inlineDiff.ts    # 行内 Diff
├── store/
│   └── useStore.ts      # Zustand 状态管理
└── config/
    └── characters.ts    # AI 专家配置
```

---

## 贡献指南 🤝

欢迎提交 Issue 和 Pull Request！

在提交代码前，请确保：
1. 代码通过 TypeScript 类型检查
2. 遵循现有的代码风格
3. 添加必要的注释

---

## 许可证 📄

MIT License

---

## 联系方式 📬

如有问题或建议，欢迎通过 Issue 反馈。

---

**祝你写作愉快！✍️**
